import{n as ie,f as E,t as ne,p as le,c as se,z as ae,j as e,x as N,b as U,a as H,T as ce,G as O,S as D}from"./index-CP9HRb84.js";import{StyleSheet as de,View as i,Text as r,Image as L,Svg as Q,Path as Y,Document as me,Page as M}from"./react-pdf.browser-Bih_bPP1.js";const t=de.create({page:{padding:34,fontSize:11,color:"#111"},row:{flexDirection:"row"},col:{flexGrow:1},h1:{fontSize:32,fontWeight:700,marginBottom:4},h2:{fontSize:13,fontWeight:700,marginTop:7,marginBottom:4},h2Tight:{fontSize:13,fontWeight:700,marginTop:0,marginBottom:4},label:{color:"#555"},box:{borderWidth:1,borderStyle:"solid",borderColor:"#e6e6e6",borderRadius:6,padding:8},table:{borderWidth:1,borderStyle:"solid",borderColor:"#e6e6e6",borderRadius:6,marginTop:2},tr:{flexDirection:"row",borderBottomWidth:1,borderStyle:"solid",borderColor:"#e0e0e0"},th:{flex:1,fontWeight:700,fontSize:11,padding:8,backgroundColor:"#f7f7f7"},td:{flex:1,padding:8,fontSize:11},right:{textAlign:"right"},small:{fontSize:10,color:"#555"},logo:{width:140,height:55,objectFit:"contain",marginBottom:0,marginTop:-20},companyDetails:{fontSize:9,color:"#555",lineHeight:1.4},sep:{height:8},footerNote:{marginTop:14,fontSize:9,color:"#555"},block:{marginTop:6},pastelGreen:{backgroundColor:"#e8f7ec"},strike:{textDecoration:"line-through",color:"#777"},itemCard:{backgroundColor:"#f5f6f8",borderRadius:8,padding:14,marginBottom:10,flexDirection:"row"},itemPhotoWrap:{width:210,height:210,backgroundColor:"transparent",borderRadius:6,alignItems:"center",justifyContent:"center",padding:6,position:"relative",marginRight:14,marginLeft:-8},dimW:{position:"absolute",bottom:-18,left:0,right:0,textAlign:"center",fontSize:10,color:"#333",paddingVertical:3},dimHWrap:{position:"absolute",top:0,bottom:-18,left:-6,alignItems:"center",justifyContent:"center"},dimH:{fontSize:10,color:"#333",transform:"rotate(-90deg)",paddingVertical:3,paddingHorizontal:3},photo:{width:170,height:170,objectFit:"contain"},itemContent:{flex:1,paddingLeft:14},itemHeader:{flexDirection:"row",justifyContent:"space-between",alignItems:"center",marginBottom:6},itemKind:{fontSize:13,fontWeight:700,color:"#111"},itemDims:{fontSize:9,color:"#666",marginLeft:6},itemQty:{fontSize:11,color:"#555",fontWeight:500},itemDescription:{fontSize:9,color:"#666",marginBottom:4},itemRef:{fontSize:9,color:"#666",marginTop:2,marginBottom:6},hr:{height:1,backgroundColor:"#e0e0e0",marginVertical:12},detailGrid:{},detailRow:{flexDirection:"row",marginBottom:2,marginTop:6},detailLabel:{width:"45%",color:"#555",paddingRight:5,fontSize:11},detailValue:{flex:1,fontWeight:500,color:"#111",fontSize:11},piecesNote:{color:"#777",fontSize:10},headerGrid:{flexDirection:"row",marginTop:2},colThird:{flex:1,paddingLeft:6,paddingRight:6},card:{borderWidth:1,borderStyle:"solid",borderColor:"#e6e6e6",borderRadius:8,padding:10,backgroundColor:"#ffffff"},brandCard:{backgroundColor:"transparent",padding:0},clientCard:{backgroundColor:"#fdfdfd",borderWidth:1,borderStyle:"solid",borderColor:"#efefef",borderRadius:8,padding:10},stampCard:{backgroundColor:"#fbfbfb",borderWidth:1,borderStyle:"dashed",borderColor:"#d1d5db",borderRadius:10,padding:10},stampTitle:{fontSize:11,fontWeight:700,marginBottom:2,color:"#111"},overline:{fontSize:8,color:"#6b7280",marginBottom:2},metaRow:{fontSize:10,color:"#0b0b0b",marginTop:2},metaLabel:{fontSize:8,color:"#6b7280",marginRight:4},poBlock:{marginTop:12,marginBottom:0},poInlineRow:{flexDirection:"row",alignItems:"center"},poImageSmall:{width:60,height:60,objectFit:"contain",borderRadius:6,alignSelf:"flex-start",marginRight:10},poGrid:{flexDirection:"row",flexWrap:"wrap",marginTop:6},poCol:{width:"50%",paddingRight:8,paddingLeft:2,paddingVertical:4},poFirstCol:{position:"relative",paddingRight:112},poEyebrow:{color:"#6b7280",fontSize:11,fontWeight:400,marginBottom:2},poTitle:{fontSize:16,fontWeight:600,color:"#0b0b0b",marginBottom:2},poDesc:{color:"#6b7280",fontSize:11,fontWeight:400,lineHeight:1.25,maxWidth:"220px"},poDivider:{width:80,height:2,backgroundColor:"#3fb26b",marginTop:6,marginBottom:6,alignSelf:"flex-start"},poTitleRow:{flexDirection:"row",alignItems:"center",marginBottom:2},poImageTiny:{width:60,height:60,objectFit:"contain",borderRadius:6,marginLeft:6},poTitleText:{lineHeight:1.05,marginRight:6},poTitleRowTight:{flexDirection:"row",alignItems:"flex-end",marginBottom:2},poImageInline:{width:50,height:50,objectFit:"contain",borderRadius:4,marginLeft:6,marginBottom:1},poHeroAbsWrap:{position:"absolute",top:0,bottom:0,right:8,width:96,justifyContent:"center",alignItems:"flex-end"},poHeroAbs:{width:96,height:96,objectFit:"contain",borderRadius:4},termsHeaderCard:{backgroundColor:"#f7f8fb",borderRadius:16,padding:18,marginTop:8,marginBottom:14},termsProfileBadge:{fontSize:8,color:"#6b7280",letterSpacing:1.6,marginBottom:6,textTransform:"uppercase"},termsTagline:{fontSize:19,fontWeight:700,color:"#111827",marginBottom:6},termsSummary:{fontSize:11,color:"#4b5563",lineHeight:1.55},termsValidityChip:{alignSelf:"flex-start",backgroundColor:"#eef1f6",paddingHorizontal:10,paddingVertical:4,borderRadius:999,marginTop:12},termsValidityText:{color:"#374151",fontSize:9.5,fontWeight:600},termsPaymentSection:{marginTop:6,marginBottom:16},termsPaymentHeader:{fontSize:9,color:"#6b7280",letterSpacing:1.4,textTransform:"uppercase",marginBottom:8},termsPaymentGroupLabel:{fontSize:9,color:"#9aa4b2",letterSpacing:1.2,textTransform:"uppercase",marginBottom:6,marginTop:10},termsPaymentRow:{flexDirection:"row",gap:14},termsPlanCard:{flex:1,borderRadius:16,padding:16,borderWidth:1,borderStyle:"solid",borderColor:"#e8ecf2",backgroundColor:"#fff"},termsPlanHeaderRow:{flexDirection:"row",alignItems:"center",marginBottom:6},termsPlanTitleInline:{fontSize:12,fontWeight:700,color:"#111827"},termsPlanStep:{marginBottom:12},termsPlanStepRow:{flexDirection:"row",alignItems:"flex-start"},termsPlanStepCircle:{width:22,height:22,borderRadius:11,backgroundColor:"#d1d5db",alignItems:"center",justifyContent:"center",marginRight:8},termsPlanStepCircleText:{fontSize:9,fontWeight:700,color:"#374151"},termsPlanStepLabel:{fontSize:11.5,fontWeight:600,color:"#1f2937"},termsPlanStepDesc:{fontSize:10,color:"#6b7280",marginTop:2,lineHeight:1.45},termsNotesIntro:{fontSize:11,color:"#111827",lineHeight:1.4,marginBottom:6},termsNotesList:{marginTop:4},termsNoteRow:{flexDirection:"row",alignItems:"flex-start",marginBottom:6},termsNoteBullet:{width:6,height:6,borderRadius:3,backgroundColor:"#9aa4b2",marginTop:5,marginRight:8},termsNoteText:{fontSize:10,color:"#4b5563",lineHeight:1.45,flex:1},termsSharedCard:{borderWidth:1,borderStyle:"solid",borderColor:"#edf0f5",borderRadius:16,padding:16,backgroundColor:"#f9fafc",marginBottom:12},termsSharedTitle:{fontSize:9,fontWeight:700,color:"#4b5563",textTransform:"uppercase",letterSpacing:1.2,marginBottom:8},termsSharedGrid:{flexDirection:"row",gap:12},termsSharedCol:{flex:1},termsSectionBlock:{borderWidth:1,borderStyle:"solid",borderColor:"#e5e7eb",borderRadius:12,padding:14,marginBottom:10},termsSectionTitle:{fontSize:12,fontWeight:700,color:"#0f172a",marginBottom:6},termsParagraph:{fontSize:10,lineHeight:1.5,color:"#6b7280",marginBottom:6},termsPrivacyCard:{backgroundColor:"#f5f6f8",borderRadius:14,padding:16,marginTop:8,borderWidth:1,borderStyle:"solid",borderColor:"#e5e7eb"},termsPrivacyTitle:{color:"#111827",fontSize:12,fontWeight:700,marginBottom:6},termsPrivacyParagraph:{color:"#374151",fontSize:10,lineHeight:1.5,marginBottom:4},termsSupplyCard:{borderRadius:16,padding:18,backgroundColor:"#fff",borderWidth:1,borderStyle:"solid",borderColor:"#e8ecf2",marginBottom:12},termsSupplyEyebrow:{fontSize:8.5,color:"#9aa4b2",letterSpacing:1.6,textTransform:"uppercase"},termsSupplyTitle:{fontSize:16,fontWeight:700,color:"#111827",marginTop:4},termsSupplySummary:{fontSize:10,color:"#6b7280",marginTop:4,marginBottom:10,lineHeight:1.45},termsSupplySteps:{flexDirection:"row",gap:10},termsSupplyStepCol:{flex:1,borderRadius:12,padding:12,backgroundColor:"#f8fafc",borderWidth:1,borderStyle:"solid",borderColor:"#eef1f6"},termsIconWrap:{width:20,height:20,borderRadius:10,backgroundColor:"#e5e7eb",alignItems:"center",justifyContent:"center",marginRight:6}});function A(o){const s=typeof o=="number"&&Number.isFinite(o)?o:0;return new Intl.NumberFormat("it-IT",{style:"currency",currency:"EUR"}).format(s)}function S(o,s="—"){return typeof o=="string"&&o.trim().length>0?o:s}function q(o){if(!o)return"—";const s=String(o).match(/^(\d{4})-(\d{2})-(\d{2})/);if(s){const[,a,d,n]=s;return`${n}-${d}-${a}`}return String(o)}function he(o){return(Array.isArray(o)?o:[]).map(a=>({category:S(a?.label??a?.category??"","-"),amount:typeof a?.amount=="number"&&Number.isFinite(a.amount)?a.amount:0,pieces:typeof a?.pieces=="number"&&Number.isFinite(a.pieces)&&a.pieces>0?a.pieces:null,surfaces:ie(a?.surfaces)}))}function fe(o){return Array.isArray(o)?o.filter(Boolean):o&&typeof o=="object"?Object.values(o).filter(Boolean):[]}function ge(o){if(!o||typeof o!="object")return"";const s=o.width_mm||o.larghezza_mm||o.larghezza,a=o.height_mm||o.altezza_mm||o.altezza;return s&&a?`L ${s} × H ${a} mm`:s?`L ${s} mm`:a?`H ${a} mm`:""}function pe(o,s){switch(o){case"finestra":return E;case"zanzariera":return ae;case"cassonetto":return se;case"persiana":return le;case"tapparella":return ne;case"porta_blindata":return E;case"porta_interna":{const a=d=>{const n=Number(d?.width_mm||800),h=Number(d?.height_mm||2100),l=d?.color||"#ffffff",P=(d?.handle_position||"left")!=="left"?n-Math.round(n*.1):Math.round(n*.1),z=`<?xml version="1.0" encoding="UTF-8"?>
<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 ${n} ${h}' width='${n}' height='${h}'>
  <rect x='0' y='0' width='${n}' height='${h}' fill='${l}' stroke='#222' stroke-width='2'/>
  <rect x='${Math.round(n*.05)}' y='${Math.round(h*.03)}' width='${Math.round(n*.9)}' height='${Math.round(h*.94)}' fill='${l}' stroke='#222' stroke-width='1'/>
  <circle cx='${P}' cy='${Math.round(h/2)}' r='${Math.round(Math.min(n,h)*.02)}' fill='#bbb' stroke='#444'/>
</svg>`;return`data:image/svg+xml;utf8,${encodeURIComponent(z)}`};if(typeof window>"u")try{const{renderToStaticMarkup:d}=require("react-dom/server"),n=require("react"),{PortaInternaSvg:h}=require("../features/quotes/porta-interna/PortaInternaSvg"),l=d(n.createElement(h,{item:s}));return`data:image/svg+xml;utf8,${encodeURIComponent(l)}`}catch{return a(s)}return a(s)}default:return E}}function v(o,s){for(const a of s)if(o[a]!==void 0&&o[a]!==null&&String(o[a]).toString().trim()!=="")return o[a]}function K(o,s="Sì",a="No"){if(typeof o=="boolean")return o?s:a;if(typeof o=="string"){const d=o.trim().toLowerCase();if(["si","sì","yes","true","1","on"].includes(d))return s;if(["no","false","0","off"].includes(d))return a}}function ue(o){if(!o||typeof o!="object")return[];const s=[];let a=Number(o.width_mm??o.larghezza_mm??o.larghezza),d=Number(o.height_mm??o.altezza_mm??o.altezza),n;String(o.kind).toLowerCase(),n=Number.isFinite(a)&&Number.isFinite(d)?a*d/1e6:void 0,n&&n>0&&s.push(["Superficie",`${n.toFixed(2)} m²`]);const h=v(o,["price_total","prezzo_totale","price","prezzo"]),l=String(o.kind).toLowerCase(),u=Number(h);h!==void 0&&l!=="tapparella"&&l!=="persiana"&&l!=="cassonetto"&&!Number.isNaN(u)&&u>0&&s.push(["Totale",String(h)]);const P=v(o,["color","colore","profile_color","profilo_colore"]);if(P&&s.push(["Colore",String(P)]),l==="porta_interna"){const p=v(o,["apertura"]);if(p){const j=p==="battente"?"Apertura a battente":"Apertura scorrevole";s.push(["Tipo apertura",j])}const c=v(o,["sliding_direction"]);if(c&&p==="scorrevole"){const j=c==="sx"?"Scorrimento a sinistra":"Scorrimento a destra";s.push(["Direzione scorrimento",j])}}const z=v(o,["wood","legno"]);z&&s.push(["Legno",String(z)]);const I=v(o,["glass","vetro"]);I&&s.push(["Vetro",String(I)]);const m=v(o,["handle","maniglia"]);m&&s.push(["Maniglia",String(m)]);const f=v(o,["foil","pellicola"]);f&&s.push(["Pellicola",String(f)]);const g=v(o,["uw"]),C=g!=null&&String(g).trim()!==""?`<= ${String(g)} W/m2K`:void 0,T=l!=="porta_interna"&&l!=="porta_blindata"?(()=>{const p=v(o,["handle_position"]);return p==="left"?"Sinistra":p==="right"?"Destra":p})():void 0,x=[["Trasmittanza",C],["Trasmittanza",v(o,["trasmittanza"])],["Telaio",K(v(o,["con_telaio"]))],["Deceleratore",K(v(o,["deceleratore","has_deceleratore","con_deceleratore"]))],["Serratura",v(o,["serratura"])?"Sì":void 0],["Spioncino",v(o,["spioncino"])?"Sì":void 0],["Posizione maniglia",T]];for(const[p,c]of x)c&&s.push([p,String(c)]);const R=new Set(s.map(([p])=>p.toLowerCase())),b=new Set(["id","kind","qty","title","label","width_mm","height_mm","larghezza_mm","altezza_mm","larghezza","altezza","price_mode","price_total","price_per_mq","unit_price","unitPrice","price","prezzo","misura_tipo","accessori_colore","reference","riferimento","image_url","imageUrl","serratura","spioncino","handle_position"]),w=String(o.kind).toLowerCase();(w==="persiana"||w==="cassonetto")&&(b.add("ante"),b.add("ante_count")),w==="porta_interna"&&(b.add("apertura"),b.add("sliding_direction"));for(const[p,c]of Object.entries(o)){if(c==null||String(c).trim()===""||typeof c=="object"||typeof c=="function"||b.has(p)||p==="serratura"||p==="spioncino"||p==="handle_position")continue;const _={profile_system:"Sistema profilo",system_profile:"Sistema profilo",color:"Colore",colore:"Colore",profilo_colore:"Colore profilo",glass:"Vetro",vetro:"Vetro",glazing:"Vetro",uw:"Trasmittanza",modello:"Modello",tipologia:"Tipologia",rete_colore:"Colore rete",rete_tipo:"Colore rete",tipo_rete:"Colore rete",mesh:"Colore rete",deceleratore:"Deceleratore",has_deceleratore:"Deceleratore",con_deceleratore:"Deceleratore",material:"Materiale",materiale:"Materiale",depth_mm:"Profondità",profondita_mm:"Profondità",celino_mm:"Celino",spalletta_mm:"Celino",extension_mm:"Celino",lamelle_type:"Lamelle",lamelle:"Lamelle",con_telaio:"Telaio",ante:"Ante",ante_count:"Ante",hinge_color:"Colore cerniere",hinges_color:"Colore cerniere",glass_spec:"Vetrocamera",vetro_stratigrafia:"Vetrocamera",stratigrafia_vetro:"Vetrocamera",handle_position:"Posizione maniglia",panel_type:"Tipo pannello"}[p]||p;if(!R.has(_.toLowerCase())){let k=String(c);(_==="Profondità"||_==="Spalletta"||_==="Celino")&&(/mm\b/i.test(k)||(k=`${k} mm`)),_==="Colore rete"&&(k=k.replace(/^mesh\s*/i,"").trim()),_==="Posizione maniglia"&&(k==="left"&&(k="Sinistra"),k==="right"&&(k="Destra")),s.push([_,k]),R.add(_.toLowerCase())}}return s}function ye({companyLogoUrl:o,brandId:s,companyDetails:a,theme:d,customer:n,quoteNumber:h,issueDate:l,validityLabel:u,installTime:P,shippingIncluded:z,hasWindows:I}){const m=d?.accent||"#3fb26b",f=d?.soft||"#e8f7ec",g=s==="ecosolution",C=Array.isArray(a)&&a.length>0?a:["X S.R.L.","P.IVA 04062850120","sede legale - Saronno (VA) 21047","Via San Giuseppe, 95","info@xinfissi.it · www.xinfissi.it · +39 345 457 3328"];if(g){const y=C.slice(1).filter(Boolean),T=y.slice(0,2).join(" · "),x=y.slice(2).join(" · ");return e.jsxs(e.Fragment,{children:[e.jsxs(i,{style:{marginBottom:10},children:[e.jsxs(i,{style:{flexDirection:"row",justifyContent:"space-between",alignItems:"flex-start"},children:[e.jsxs(i,{style:{flex:1,paddingRight:10},children:[e.jsx(r,{style:{fontSize:9,color:"#6b7280",textTransform:"uppercase"},children:"Ecosolutions"}),e.jsx(r,{style:{fontSize:10,color:"#111827",marginTop:2},children:C[0]||"Ecosolutions"}),T?e.jsx(r,{style:{fontSize:8.6,color:"#6b7280",marginTop:1},children:T}):null,x?e.jsx(r,{style:{fontSize:8.6,color:"#6b7280"},children:x}):null]}),o&&o.trim()?e.jsx(L,{src:o,style:t.logo}):e.jsx(L,{src:N,style:t.logo})]}),e.jsx(i,{style:{height:1,backgroundColor:m,marginTop:6}})]}),e.jsxs(i,{style:{flexDirection:"row",gap:8},children:[e.jsxs(i,{style:{flex:1.2,backgroundColor:"#f8fafc",borderRadius:10,padding:9},children:[e.jsx(r,{style:[t.label,{color:"#6b7280"}],children:"Spettabile"}),e.jsx(r,{children:S(n?.name)}),S(n?.address,"")!==""?e.jsx(r,{children:S(n?.address)}):null,(()=>{const R=[S(n?.email,""),S(n?.phone,""),n?.vat&&n.vat.trim()?`P.IVA ${n.vat.trim()}`:""].filter(b=>b&&b.trim()!=="");return R.length>0?e.jsx(r,{style:t.small,children:R.join(" · ")}):null})()]}),e.jsxs(i,{style:{flex:.9,backgroundColor:f,borderRadius:10,padding:9},children:[e.jsx(r,{style:{fontSize:8,color:"#6b7280",textTransform:"uppercase"},children:"Offerta"}),e.jsx(r,{style:{fontSize:12,fontWeight:700,color:"#111827",marginTop:2},children:S(h,"-")}),e.jsxs(r,{style:{fontSize:9,color:"#374151",marginTop:5},children:["Emesso: ",q(l)]}),e.jsxs(r,{style:{fontSize:9,color:"#374151",marginTop:1},children:["Validità: ",S(u)]}),e.jsxs(r,{style:{fontSize:9,color:"#374151",marginTop:1},children:["Tempi di produzione: ",S(P)]})]})]}),!g&&I&&e.jsx(i,{style:{marginTop:8,backgroundColor:"#f9fafb",borderRadius:9,paddingVertical:7,paddingHorizontal:9},children:e.jsxs(i,{style:[t.row,{marginTop:0}],children:[e.jsxs(i,{style:{flex:1,paddingRight:8},children:[e.jsx(r,{style:t.label,children:"Ferramenta"}),e.jsx(r,{wrap:!1,children:"WINKHAUS + HOPPE"})]}),z&&e.jsxs(i,{style:{flex:1,paddingLeft:8},children:[e.jsx(r,{style:t.label,children:"Servizi"}),e.jsx(r,{wrap:!1,children:"Trasporto incluso"})]})]})})]})}return e.jsxs(e.Fragment,{children:[e.jsxs(i,{style:[t.headerGrid],children:[e.jsx(i,{style:t.colThird,children:e.jsxs(i,{style:t.brandCard,children:[o&&o.trim()?e.jsx(L,{src:o,style:t.logo}):e.jsx(L,{src:N,style:t.logo}),e.jsx(r,{style:t.companyDetails,children:C.join(`
`)})]})}),e.jsx(i,{style:t.colThird,children:e.jsxs(i,{style:t.clientCard,children:[e.jsx(r,{style:t.h2Tight,children:"Spettabile"}),e.jsx(r,{children:S(n?.name)}),S(n?.address,"")!==""?e.jsx(r,{children:S(n?.address)}):null,(()=>{const y=[S(n?.email,""),S(n?.phone,""),n?.vat&&n.vat.trim()?`P.IVA ${n.vat.trim()}`:""].filter(T=>T&&T.trim()!=="");return y.length>0?e.jsx(r,{style:t.small,children:y.join(" · ")}):null})()]})}),e.jsx(i,{style:t.colThird,children:e.jsxs(i,{style:[t.stampCard,{borderColor:m,backgroundColor:f}],children:[e.jsxs(r,{style:t.stampTitle,children:["Offerta n° ",S(h,"-")]}),e.jsxs(r,{style:t.metaRow,children:[e.jsx(r,{style:t.metaLabel,children:"Emesso:"})," ",q(l)]}),e.jsxs(r,{style:t.metaRow,children:[e.jsx(r,{style:t.metaLabel,children:"Validità:"})," ",S(u)]}),e.jsxs(r,{style:t.metaRow,children:[e.jsx(r,{style:t.metaLabel,children:"Termini completamento:"})," ",S(P)]})]})})]}),e.jsx(i,{style:t.block,children:e.jsx(i,{style:t.box,children:I&&e.jsxs(i,{style:[t.row,{marginTop:0}],children:[e.jsxs(i,{style:{flex:1,paddingRight:8},children:[e.jsx(r,{style:t.label,children:"Ferramenta"}),e.jsx(r,{wrap:!1,children:"WINKHAUS + HOPPE"})]}),z&&e.jsxs(i,{style:{flex:1,paddingLeft:8},children:[e.jsx(r,{style:t.label,children:"Servizi"}),e.jsx(r,{wrap:!1,children:"Trasporto incluso"})]})]})})})]})}function xe({profileOverview:o}){const s=o&&o||null,a=Array.isArray(s?.features)?s.features.filter(Boolean):[];return!s?.imageUrl&&a.length===0?null:e.jsx(i,{style:[t.block,t.poBlock,{paddingTop:2,paddingBottom:2}],children:e.jsx(i,{style:t.poGrid,children:a.map((d,n)=>{const h=n===0;return e.jsxs(i,{style:h?[t.poCol,t.poFirstCol]:[t.poCol],wrap:!1,children:[d.eyebrow?e.jsx(r,{style:t.poEyebrow,children:String(d.eyebrow)}):null,d.title?e.jsx(r,{style:[t.poTitle,t.poTitleText],children:String(d.title)}):null,h&&s?.imageUrl?e.jsx(i,{style:t.poHeroAbsWrap,children:e.jsx(L,{src:s.imageUrl,style:t.poHeroAbs})}):null,d.description?e.jsx(r,{style:t.poDesc,children:String(d.description)}):null,e.jsx(i,{style:t.poDivider})]},`pof-${n}`)})})})}function be({brandId:o,totals:s,items:a,mountingCost:d,hasDiscount:n,originalTotal:h,discountedTotal:l,discount:u,showTotalIncl:P,vatPercent:z,theme:I}){const m=I?.soft||"#e8f7ec",f=o==="ecosolution";if(f){const g=!!P,C=typeof z=="number"&&Number.isFinite(z)?z:22,T=(n?l:h)*(1+C/100);return e.jsxs(i,{style:t.block,children:[e.jsx(r,{style:t.h2,children:"Riepilogo preventivo"}),e.jsxs(i,{style:t.table,children:[e.jsxs(i,{style:t.tr,children:[e.jsx(r,{style:[t.th,{flex:2}],children:"Categoria"}),e.jsx(r,{style:[t.th,t.right],children:"Importo"})]}),s.length>0?s.map((x,R)=>{const b=S(x.category,"-"),w=`eco-row-${b}-${Number.isFinite(x.amount)?x.amount:0}-${R}`,p=x.pieces,c=U(x.surfaces,a);return e.jsxs(i,{style:t.tr,children:[e.jsxs(r,{style:[t.td,{flex:2}],children:[e.jsx(r,{children:b}),typeof p=="number"&&p>0?e.jsxs(r,{style:t.piecesNote,children:[" · ",p," pezzi "]}):null,c.map(j=>e.jsxs(r,{style:t.piecesNote,children:[" ","· ",H(j.mq),j.missingDimensions>0?` (${j.missingDimensions} senza dimensioni)`:""]},`${w}-${j.id}`))]}),e.jsx(r,{style:[t.td,t.right],children:A(x.amount)})]},w)}):e.jsxs(i,{style:t.tr,children:[e.jsx(r,{style:[t.td,{flex:2,color:"#777"}],children:"—"}),e.jsx(r,{style:[t.td,t.right,{color:"#777"}],children:"—"})]}),typeof d=="number"&&Number.isFinite(d)&&e.jsxs(i,{style:t.tr,children:[e.jsx(r,{style:[t.td,{flex:2}],children:"Montaggio"}),e.jsx(r,{style:[t.td,t.right],children:A(d)})]}),n?e.jsxs(e.Fragment,{children:[e.jsxs(i,{style:[t.tr],children:[e.jsx(r,{style:[t.td,{flex:2,fontWeight:700,backgroundColor:"#f7f7f7"}],children:"TOTALE (IVA ESCLUSA)"}),e.jsx(r,{style:[t.td,t.right,{fontWeight:700,backgroundColor:"#f7f7f7"}],children:A(h)})]}),e.jsxs(i,{style:[t.tr,{borderBottomWidth:0,backgroundColor:m}],children:[e.jsx(r,{style:[t.td,{flex:2,fontWeight:700}],children:u?.mode==="pct"&&typeof u?.pct=="number"&&u.pct>0?`TOTALE SCONTATO DEL ${u.pct}% (IVA ESCLUSA)`:"TOTALE SCONTATO (IVA ESCLUSA)"}),e.jsx(r,{style:[t.td,t.right,{fontWeight:700}],children:A(l)})]})]}):e.jsxs(i,{style:[t.tr,{borderBottomWidth:0}],children:[e.jsx(r,{style:[t.td,{flex:2,fontWeight:700,backgroundColor:"#f7f7f7"}],children:"TOTALE (IVA ESCLUSA)"}),e.jsx(r,{style:[t.td,t.right,{fontWeight:700,backgroundColor:"#f7f7f7"}],children:A(h)})]}),g?e.jsxs(i,{style:[t.tr,{borderTopWidth:0}],children:[e.jsx(r,{style:[t.td,{flex:2,fontWeight:700}],children:"TOTALE (IVA INCLUSA)"}),e.jsx(r,{style:[t.td,t.right,{fontWeight:700}],children:A(T)})]}):null]})]})}return e.jsxs(i,{style:t.block,children:[e.jsx(r,{style:t.h2,children:"Riepilogo preventivo"}),e.jsxs(i,{style:t.table,children:[e.jsxs(i,{style:t.tr,children:[e.jsx(r,{style:[t.th,{flex:2}],children:"Categoria"}),e.jsx(r,{style:[t.th,t.right],children:"Importo"})]}),s.length>0?s.map((g,C)=>{const y=S(g.category,"-"),T=`row-${y}-${Number.isFinite(g.amount)?g.amount:0}-${C}`,x=g.pieces,R=U(g.surfaces,a),b=[];return typeof x=="number"&&x>0&&b.push(`${x} pezzi`),R.length>0&&b.push(...R.map(w=>`${H(w.mq)}${w.missingDimensions>0?` (${w.missingDimensions} senza dimensioni)`:""}`)),e.jsx(i,{style:t.tr,children:f?e.jsxs(e.Fragment,{children:[e.jsx(r,{style:[t.td,{flex:1.5,fontWeight:700}],children:y}),e.jsx(r,{style:[t.td,{flex:2,color:"#4b5563"}],children:b.join(" · ")||"—"}),e.jsx(r,{style:[t.td,t.right],children:A(g.amount)})]}):e.jsxs(e.Fragment,{children:[e.jsxs(r,{style:[t.td,{flex:2}],children:[e.jsx(r,{children:y}),typeof x=="number"&&x>0?e.jsxs(r,{style:t.piecesNote,children:[" · ",x," pezzi "]}):null,R.map(w=>e.jsxs(r,{style:t.piecesNote,children:[" ","· ",H(w.mq),w.missingDimensions>0?` (${w.missingDimensions} senza dimensioni)`:""]},`${T}-${w.id}`))]}),e.jsx(r,{style:[t.td,t.right],children:A(g.amount)})]})},T)}):e.jsxs(i,{style:t.tr,children:[e.jsx(r,{style:[t.td,{flex:2,color:"#777"}],children:"—"}),e.jsx(r,{style:[t.td,t.right,{color:"#777"}],children:"—"})]}),typeof d=="number"&&Number.isFinite(d)&&e.jsxs(i,{style:t.tr,children:[e.jsx(r,{style:[t.td,{flex:2}],children:"Montaggio"}),e.jsx(r,{style:[t.td,t.right],children:A(d)})]}),n?e.jsxs(e.Fragment,{children:[e.jsxs(i,{style:[t.tr],children:[e.jsx(r,{style:[t.td,{flex:2,fontWeight:700,backgroundColor:"#f7f7f7"}],children:"TOTALE (IVA ESCLUSA)"}),e.jsx(r,{style:[t.td,t.right,{fontWeight:700,backgroundColor:"#f7f7f7"}],children:A(h)})]}),e.jsxs(i,{style:[t.tr,{borderBottomWidth:0,backgroundColor:"#e8f7ec"}],children:[e.jsx(r,{style:[t.td,{flex:2,fontWeight:700}],children:u?.mode==="pct"&&typeof u?.pct=="number"&&u.pct>0?`TOTALE SCONTATO DEL ${u.pct}% (IVA ESCLUSA)`:"TOTALE SCONTATO (IVA ESCLUSA)"}),e.jsx(r,{style:[t.td,t.right,{fontWeight:700}],children:A(l)})]})]}):e.jsxs(i,{style:[t.tr,{borderBottomWidth:0}],children:[e.jsx(r,{style:[t.td,{flex:2,fontWeight:700,backgroundColor:"#f7f7f7"}],children:"TOTALE (IVA ESCLUSA)"}),e.jsx(r,{style:[t.td,t.right,{fontWeight:700,backgroundColor:"#f7f7f7"}],children:A(h)})]}),(()=>{const g=!!P,C=typeof z=="number"&&Number.isFinite(z)?z:22,y=n?l:h;if(!g)return null;const T=y*(1+C/100);return e.jsxs(i,{style:[t.tr,{borderTopWidth:0}],children:[e.jsx(r,{style:[t.td,{flex:2,fontWeight:700}],children:"TOTALE (IVA INCLUSA)"}),e.jsx(r,{style:[t.td,t.right,{fontWeight:700}],children:A(T)})]})})()]})]})}function je({companyLogoUrl:o,brandId:s,theme:a,items:d}){const n=s==="ecosolution",h=a?.accent||"#3fb26b";return e.jsxs(e.Fragment,{children:[o&&o.trim()?e.jsx(L,{src:o,style:t.logo}):e.jsx(L,{src:N,style:t.logo}),e.jsxs(i,{style:t.block,children:[e.jsx(r,{style:t.h2,children:"Dettaglio voci"}),d.length>0?d.map((l,u)=>{const P=l?.kind==="custom",z=u>0&&u%2===0,I=P?[]:ue(l),m=Array.isArray(l?.custom_fields)?l.custom_fields.filter(c=>{const j=c?.name??c?.label??c?.key,_=c?.value;return j&&String(j).trim()&&_!=null&&String(_).trim()}).map(c=>[String(c?.name??c?.label??c?.key).trim(),String(c?.value).trim()]):[],f=P?m:[...I,...m],g=(()=>{if(l?.title&&l.title.trim())return l.title.trim();let c=String(l?.kind||"Voce").trim();return c==="porta_blindata"&&(c="Porta blindata"),c.charAt(0).toUpperCase()+c.slice(1)})(),C=`Q.tà ${Number.isFinite(Number(l?.qty))?String(l.qty):"1"}`,y=String(l?.kind||"").toLowerCase(),T=ge(l),x=f.length,b=Math.max(260,80+Math.min(40,x*7)),w=t.itemPhotoWrap,p=typeof l?.reference=="string"&&l.reference.trim()?l.reference.trim():typeof l?.riferimento=="string"&&l.riferimento.trim()?l.riferimento.trim():"";return e.jsxs(i,{wrap:!1,break:z,children:[e.jsxs(i,{style:[t.itemCard,{minHeight:b},...n?[{backgroundColor:"#ffffff"}]:[]],children:[e.jsxs(i,{style:{width:20,alignItems:"center",marginRight:6,paddingTop:2},children:[e.jsx(r,{style:{fontSize:5,color:n?h:"#bbb",letterSpacing:.3},children:n?"VOCE":"POS"}),e.jsx(r,{style:{fontSize:10,color:n?h:"#999",marginTop:1},children:u+1})]}),e.jsxs(i,{style:w,children:[(()=>{try{const c=typeof l?.image_url=="string"?l.image_url:"",j=c&&!c.startsWith("blob:")?c:pe(l?.kind,l),_=typeof j=="string"?j:N;return e.jsx(L,{src:_,style:t.photo})}catch(c){return console.warn("Errore nel calcolo immagine voce PDF",c),e.jsx(L,{src:N,style:t.photo})}})(),(()=>{const c=l?.width_mm??l?.larghezza_mm??l?.larghezza?String(l?.width_mm??l?.larghezza_mm??l?.larghezza):"—",j=l?.height_mm??l?.altezza_mm??l?.altezza?String(l?.height_mm??l?.altezza_mm??l?.altezza):"—";if(!(y==="finestra"||y==="cassonetto"||y==="tapparella"||y==="persiana"||y==="porta_blindata"||y==="porta_interna")){const k=(()=>{switch(y){case"zanzariera":case"custom":return-6;default:return-18}})(),$=(()=>{switch(y){case"zanzariera":case"custom":return 6;default:return 6}})();return e.jsxs(e.Fragment,{children:[e.jsx(r,{style:[t.dimW,{bottom:k}],children:c}),e.jsx(i,{style:[t.dimHWrap,{left:$}],children:e.jsx(r,{style:t.dimH,children:j})})]})}return null})()]}),e.jsxs(i,{style:t.itemContent,children:[e.jsxs(i,{style:t.itemHeader,children:[e.jsxs(i,{style:{flexDirection:"row",alignItems:"center",flexShrink:1},children:[e.jsx(r,{style:[t.itemKind,n?{color:"#111827",fontSize:14}:{}],children:g}),(()=>{const c=T;return c?e.jsxs(r,{style:[t.itemDims,n?{color:"#4b5563"}:{}],children:["· ",c]}):null})()]}),e.jsx(r,{style:t.itemQty,children:C})]}),p?e.jsx(r,{style:t.itemRef,children:p}):null,f.length>0&&e.jsx(i,{style:[t.hr,n?{backgroundColor:"#edf2f7",marginVertical:10}:{}]}),e.jsx(i,{style:t.detailGrid,children:f.map(([c,j],_)=>e.jsxs(i,{style:[t.detailRow,n?{marginTop:4,marginBottom:3}:{}],children:[e.jsx(r,{style:[t.detailLabel,n?{width:"40%",color:"#6b7280",fontSize:10}:{}],children:c}),e.jsx(r,{style:[t.detailValue,n?{fontSize:10.5,color:"#111827",fontWeight:600}:{}],children:j})]},`kv-${_}`))})]})]}),n&&u<d.length-1?e.jsx(i,{style:{height:1,backgroundColor:h,opacity:.8,marginTop:-2,marginBottom:8}}):null]},`item-wrap-${l?.id||l?.kind||"k"}-${u}`)}):e.jsx(i,{style:[t.itemCard,{justifyContent:"center"}],children:e.jsx(r,{style:{color:"#666"},children:"— Nessuna voce inserita —"})})]})]})}const Se=()=>e.jsx(Q,{width:14,height:14,viewBox:"0 0 24 24",children:e.jsx(Y,{d:"M12 12a4 4 0 1 0-4-4 4 4 0 0 0 4 4zm0 2c-4.42 0-8 2.24-8 5v1h16v-1c0-2.76-3.58-5-8-5z",fill:"#475467"})}),ze=()=>e.jsx(Q,{width:14,height:14,viewBox:"0 0 24 24",children:e.jsx(Y,{d:"M4 20V4a2 2 0 0 1 2-2h8a2 2 0 0 1 2 2v6h4v10h-6v-3h-4v3H4zm4-12h2v2H8V8zm0 4h2v2H8v-2zm4-4h2v2h-2V8zm0 4h2v2h-2v-2z",fill:"#475467"})});function Te({companyLogoUrl:o,theme:s,structuredTerms:a,terms:d,supplyOnlyPlan:n,paymentPlanColumns:h,sharedPaymentNotes:l,sharedNotesLeft:u,sharedNotesRight:P}){const z=s?.accent||"#3fb26b",I=s?.soft||"#f7f8fb";return e.jsxs(e.Fragment,{children:[o&&o.trim()?e.jsx(L,{src:o,style:t.logo}):e.jsx(L,{src:N,style:t.logo}),e.jsx(r,{style:[t.h2,{marginTop:6}],children:"Condizioni di Fornitura"}),e.jsx(i,{style:{height:1,backgroundColor:I,marginVertical:10}}),a?e.jsxs(e.Fragment,{children:[e.jsxs(i,{style:t.termsPaymentSection,children:[e.jsx(r,{style:[t.termsPaymentHeader,{color:z}],children:"Metodi di pagamento"}),e.jsxs(i,{style:t.termsSupplyCard,wrap:!1,children:[e.jsx(r,{style:t.termsSupplyTitle,children:"Solo fornitura (senza posa)"}),e.jsx(r,{style:t.termsSupplySummary,children:n.summary}),e.jsx(i,{style:t.termsSupplySteps,children:(n.steps||[]).map((m,f)=>e.jsx(i,{style:t.termsSupplyStepCol,children:e.jsxs(i,{style:t.termsPlanStepRow,children:[e.jsx(i,{style:t.termsPlanStepCircle,children:e.jsx(r,{style:t.termsPlanStepCircleText,children:String(f+1)})}),e.jsxs(i,{style:{flex:1},children:[e.jsx(r,{style:t.termsPlanStepLabel,children:m.label}),e.jsx(r,{style:t.termsPlanStepDesc,children:m.description})]})]})},`supply-step-${f}`))})]}),e.jsx(r,{style:t.termsPaymentGroupLabel,children:"Fornitura e posa"}),e.jsx(i,{style:t.termsPaymentRow,children:h.map(m=>e.jsxs(i,{style:t.termsPlanCard,wrap:!1,children:[e.jsxs(i,{style:t.termsPlanHeaderRow,children:[e.jsx(i,{style:t.termsIconWrap,children:m.id==="azienda"?e.jsx(ze,{}):e.jsx(Se,{})}),e.jsx(r,{style:t.termsPlanTitleInline,children:m.id==="azienda"?"Aziende":"Privati"})]}),m.summary?e.jsx(r,{style:t.termsParagraph,children:m.summary}):null,(m.steps||[]).map((f,g)=>e.jsx(i,{style:t.termsPlanStep,children:e.jsxs(i,{style:t.termsPlanStepRow,children:[e.jsx(i,{style:t.termsPlanStepCircle,children:e.jsx(r,{style:t.termsPlanStepCircleText,children:String(g+1)})}),e.jsxs(i,{style:{flex:1},children:[e.jsx(r,{style:t.termsPlanStepLabel,children:f.label}),e.jsx(r,{style:t.termsPlanStepDesc,children:f.description})]})]})},`terms-plan-${m.id}-${g}`))]},`terms-plan-${m.id}`))})]}),l.length>0&&e.jsxs(i,{style:t.termsSharedCard,wrap:!1,children:[e.jsx(r,{style:t.termsSharedTitle,children:"Regole generali sui pagamenti"}),e.jsxs(i,{style:t.termsSharedGrid,children:[e.jsx(i,{style:t.termsSharedCol,children:u.map((m,f)=>e.jsxs(i,{style:t.termsNoteRow,children:[e.jsx(i,{style:t.termsNoteBullet}),e.jsx(r,{style:t.termsNoteText,children:m})]},`shared-note-left-${f}`))}),e.jsx(i,{style:t.termsSharedCol,children:P.map((m,f)=>e.jsxs(i,{style:t.termsNoteRow,children:[e.jsx(i,{style:t.termsNoteBullet}),e.jsx(r,{style:t.termsNoteText,children:m})]},`shared-note-right-${f}`))})]})]}),(a.sections||[]).map((m,f)=>e.jsxs(i,{style:t.termsSectionBlock,wrap:!1,children:[e.jsx(r,{style:t.termsSectionTitle,children:m.title}),(m.body||[]).map((g,C)=>e.jsx(r,{style:t.termsParagraph,children:g},`section-${f}-p-${C}`))]},`section-${f}`)),e.jsxs(i,{style:t.termsPrivacyCard,wrap:!1,children:[e.jsx(r,{style:t.termsPrivacyTitle,children:a.privacy.title}),(a.privacy.body||[]).map((m,f)=>e.jsx(r,{style:t.termsPrivacyParagraph,children:m},`privacy-${f}`))]})]}):e.jsx(r,{children:S(d)}),e.jsxs(i,{style:{marginTop:22},children:[e.jsx(r,{children:"Letto e confermato in ______________________ in data _____________________"}),e.jsx(i,{style:{height:28}}),e.jsxs(i,{style:t.row,children:[e.jsxs(i,{style:[t.col],children:[e.jsx(r,{children:"Cliente"}),e.jsx(i,{style:{height:40,borderBottomWidth:1,borderStyle:"solid",borderColor:"#e6e6e6",marginRight:18}})]}),e.jsxs(i,{style:[t.col],children:[e.jsx(r,{children:"Fornitore"}),e.jsx(i,{style:{height:40,borderBottomWidth:1,borderStyle:"solid",borderColor:"#e6e6e6",marginRight:18}})]})]})]})]})}function Pe(o){const{companyLogoUrl:s,brandId:a,companyDetails:d,pdfTheme:n,quoteNumber:h,issueDate:l,installTime:u,showShippingIncluded:P,customer:z,catTotals:I,mountingCost:m,totalExcluded:f,validityLabel:g,validityDays:C,terms:y,termsStructured:T,items:x,profileOverview:R}=o||{},b=fe(x),w=P!==!1,p=b.some(W=>{const B=String(W?.kind||"").toLowerCase();return B==="finestra"||B==="portafinestra"||B==="scorrevole"||/serrament/i.test(B)}),c=he(I),j=typeof m=="number"&&Number.isFinite(m)?m:0,_=c.reduce((W,B)=>W+B.amount,0)+j,k=!!(o?.discount&&typeof o.discount.discountedTotal=="number"&&o.discount.discountedTotal>=0&&o.discount.discountedTotal<(o.discount.originalTotal??1/0)),$=k?o.discount?.originalTotal??_:typeof f=="number"&&Number.isFinite(f)?f:_,X=k?o.discount.discountedTotal:$,V=typeof C=="number"&&isFinite(C)?`VALIDITÀ OFFERTA: ${C} giorni`:S(g),J=V&&V!=="—"?V.replace(/VALIDIT[ÀA][’']?\s*OFFERTA\s*:\s*/i,"").trim():"—",Z=T&&typeof T=="object"?T:null,ee=["privato","azienda"].map(W=>ce.find(B=>B.id===W)).filter(W=>!!W).map(W=>({id:W.id,label:W.label,tagline:W.tagline,summary:W.summary,steps:W.paymentPlan})),te={label:D.label,tagline:D.tagline,summary:D.summary,steps:D.steps},F=O&&O.length>0?O:[],G=Math.ceil(F.length/2),re=F.slice(0,G),oe=F.slice(G);return e.jsxs(me,{children:[e.jsxs(M,{size:"A4",style:t.page,children:[e.jsx(ye,{companyLogoUrl:s,brandId:a??null,companyDetails:d??null,theme:n??null,customer:z,quoteNumber:h,issueDate:l,validityLabel:J,installTime:u,shippingIncluded:w,hasWindows:p}),e.jsx(xe,{profileOverview:R}),e.jsx(be,{brandId:a??null,totals:c,items:b,mountingCost:m,hasDiscount:k,originalTotal:$,discountedTotal:X,discount:o.discount??null,showTotalIncl:o.showTotalIncl,vatPercent:o.vatPercent,theme:n??null})]}),e.jsx(M,{size:"A4",style:t.page,children:e.jsx(je,{companyLogoUrl:s,items:b,brandId:a??null,theme:n??null})}),e.jsx(M,{size:"A4",style:t.page,children:e.jsx(Te,{companyLogoUrl:s,theme:n??null,structuredTerms:Z,terms:y,supplyOnlyPlan:te,paymentPlanColumns:ee,sharedPaymentNotes:F,sharedNotesLeft:re,sharedNotesRight:oe})})]})}export{Pe as QuotePDF,Pe as default};
