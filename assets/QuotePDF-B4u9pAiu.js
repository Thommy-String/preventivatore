import{n as J,f as $,t as Z,p as ee,c as te,z as re,j as e,x as W,b as oe,a as ie,T as ne,G as F,S as A}from"./index-BgUM0KLk.js";import{StyleSheet as le,View as n,Image as R,Text as i,Svg as M,Path as O,Document as se,Page as H}from"./react-pdf.browser-BkyLsaBa.js";const t=le.create({page:{padding:34,fontSize:11,color:"#111"},row:{flexDirection:"row"},col:{flexGrow:1},h1:{fontSize:32,fontWeight:700,marginBottom:4},h2:{fontSize:13,fontWeight:700,marginTop:7,marginBottom:4},h2Tight:{fontSize:13,fontWeight:700,marginTop:0,marginBottom:4},label:{color:"#555"},box:{borderWidth:1,borderStyle:"solid",borderColor:"#e6e6e6",borderRadius:6,padding:8},table:{borderWidth:1,borderStyle:"solid",borderColor:"#e6e6e6",borderRadius:6,marginTop:2},tr:{flexDirection:"row",borderBottomWidth:1,borderStyle:"solid",borderColor:"#e0e0e0"},th:{flex:1,fontWeight:700,fontSize:11,padding:8,backgroundColor:"#f7f7f7"},td:{flex:1,padding:8,fontSize:11},right:{textAlign:"right"},small:{fontSize:10,color:"#555"},logo:{width:140,height:55,objectFit:"contain",marginBottom:0,marginTop:-20},companyDetails:{fontSize:9,color:"#555",lineHeight:1.4},sep:{height:8},footerNote:{marginTop:14,fontSize:9,color:"#555"},block:{marginTop:6},pastelGreen:{backgroundColor:"#e8f7ec"},strike:{textDecoration:"line-through",color:"#777"},itemCard:{backgroundColor:"#f5f6f8",borderRadius:8,padding:14,marginBottom:10,flexDirection:"row"},itemPhotoWrap:{width:210,height:210,backgroundColor:"transparent",borderRadius:6,alignItems:"center",justifyContent:"center",padding:6,position:"relative",marginRight:14,marginLeft:-8},dimW:{position:"absolute",bottom:-18,left:0,right:0,textAlign:"center",fontSize:10,color:"#333",paddingVertical:3},dimHWrap:{position:"absolute",top:0,bottom:-18,left:-6,alignItems:"center",justifyContent:"center"},dimH:{fontSize:10,color:"#333",transform:"rotate(-90deg)",paddingVertical:3,paddingHorizontal:3},photo:{width:170,height:170,objectFit:"contain"},itemContent:{flex:1,paddingLeft:14},itemHeader:{flexDirection:"row",justifyContent:"space-between",alignItems:"center",marginBottom:6},itemKind:{fontSize:13,fontWeight:700,color:"#111"},itemDims:{fontSize:9,color:"#666",marginLeft:6},itemQty:{fontSize:11,color:"#555",fontWeight:500},itemDescription:{fontSize:9,color:"#666",marginBottom:4},itemRef:{fontSize:9,color:"#666",marginTop:2,marginBottom:6},hr:{height:1,backgroundColor:"#e0e0e0",marginVertical:12},detailGrid:{},detailRow:{flexDirection:"row",marginBottom:2,marginTop:6},detailLabel:{width:"45%",color:"#555",paddingRight:5,fontSize:11},detailValue:{flex:1,fontWeight:500,color:"#111",fontSize:11},piecesNote:{color:"#777",fontSize:10},headerGrid:{flexDirection:"row",marginTop:2},colThird:{flex:1,paddingLeft:6,paddingRight:6},card:{borderWidth:1,borderStyle:"solid",borderColor:"#e6e6e6",borderRadius:8,padding:10,backgroundColor:"#ffffff"},brandCard:{backgroundColor:"transparent",padding:0},clientCard:{backgroundColor:"#fdfdfd",borderWidth:1,borderStyle:"solid",borderColor:"#efefef",borderRadius:8,padding:10},stampCard:{backgroundColor:"#fbfbfb",borderWidth:1,borderStyle:"dashed",borderColor:"#d1d5db",borderRadius:10,padding:10},stampTitle:{fontSize:11,fontWeight:700,marginBottom:2,color:"#111"},overline:{fontSize:8,color:"#6b7280",marginBottom:2},metaRow:{fontSize:10,color:"#0b0b0b",marginTop:2},metaLabel:{fontSize:8,color:"#6b7280",marginRight:4},poBlock:{marginTop:12,marginBottom:0},poInlineRow:{flexDirection:"row",alignItems:"center"},poImageSmall:{width:60,height:60,objectFit:"contain",borderRadius:6,alignSelf:"flex-start",marginRight:10},poGrid:{flexDirection:"row",flexWrap:"wrap",marginTop:6},poCol:{width:"50%",paddingRight:8,paddingLeft:2,paddingVertical:4},poFirstCol:{position:"relative",paddingRight:112},poEyebrow:{color:"#6b7280",fontSize:11,fontWeight:400,marginBottom:2},poTitle:{fontSize:16,fontWeight:600,color:"#0b0b0b",marginBottom:2},poDesc:{color:"#6b7280",fontSize:11,fontWeight:400,lineHeight:1.25,maxWidth:"220px"},poDivider:{width:80,height:2,backgroundColor:"#3fb26b",marginTop:6,marginBottom:6,alignSelf:"flex-start"},poTitleRow:{flexDirection:"row",alignItems:"center",marginBottom:2},poImageTiny:{width:60,height:60,objectFit:"contain",borderRadius:6,marginLeft:6},poTitleText:{lineHeight:1.05,marginRight:6},poTitleRowTight:{flexDirection:"row",alignItems:"flex-end",marginBottom:2},poImageInline:{width:50,height:50,objectFit:"contain",borderRadius:4,marginLeft:6,marginBottom:1},poHeroAbsWrap:{position:"absolute",top:0,bottom:0,right:8,width:96,justifyContent:"center",alignItems:"flex-end"},poHeroAbs:{width:96,height:96,objectFit:"contain",borderRadius:4},termsHeaderCard:{backgroundColor:"#f7f8fb",borderRadius:16,padding:18,marginTop:8,marginBottom:14},termsProfileBadge:{fontSize:8,color:"#6b7280",letterSpacing:1.6,marginBottom:6,textTransform:"uppercase"},termsTagline:{fontSize:19,fontWeight:700,color:"#111827",marginBottom:6},termsSummary:{fontSize:11,color:"#4b5563",lineHeight:1.55},termsValidityChip:{alignSelf:"flex-start",backgroundColor:"#eef1f6",paddingHorizontal:10,paddingVertical:4,borderRadius:999,marginTop:12},termsValidityText:{color:"#374151",fontSize:9.5,fontWeight:600},termsPaymentSection:{marginTop:6,marginBottom:16},termsPaymentHeader:{fontSize:9,color:"#6b7280",letterSpacing:1.4,textTransform:"uppercase",marginBottom:8},termsPaymentGroupLabel:{fontSize:9,color:"#9aa4b2",letterSpacing:1.2,textTransform:"uppercase",marginBottom:6,marginTop:10},termsPaymentRow:{flexDirection:"row",gap:14},termsPlanCard:{flex:1,borderRadius:16,padding:16,borderWidth:1,borderStyle:"solid",borderColor:"#e8ecf2",backgroundColor:"#fff"},termsPlanHeaderRow:{flexDirection:"row",alignItems:"center",marginBottom:6},termsPlanTitleInline:{fontSize:12,fontWeight:700,color:"#111827"},termsPlanStep:{marginBottom:12},termsPlanStepRow:{flexDirection:"row",alignItems:"flex-start"},termsPlanStepCircle:{width:22,height:22,borderRadius:11,backgroundColor:"#d1d5db",alignItems:"center",justifyContent:"center",marginRight:8},termsPlanStepCircleText:{fontSize:9,fontWeight:700,color:"#374151"},termsPlanStepLabel:{fontSize:11.5,fontWeight:600,color:"#1f2937"},termsPlanStepDesc:{fontSize:10,color:"#6b7280",marginTop:2,lineHeight:1.45},termsNotesIntro:{fontSize:11,color:"#111827",lineHeight:1.4,marginBottom:6},termsNotesList:{marginTop:4},termsNoteRow:{flexDirection:"row",alignItems:"flex-start",marginBottom:6},termsNoteBullet:{width:6,height:6,borderRadius:3,backgroundColor:"#9aa4b2",marginTop:5,marginRight:8},termsNoteText:{fontSize:10,color:"#4b5563",lineHeight:1.45,flex:1},termsSharedCard:{borderWidth:1,borderStyle:"solid",borderColor:"#edf0f5",borderRadius:16,padding:16,backgroundColor:"#f9fafc",marginBottom:12},termsSharedTitle:{fontSize:9,fontWeight:700,color:"#4b5563",textTransform:"uppercase",letterSpacing:1.2,marginBottom:8},termsSharedGrid:{flexDirection:"row",gap:12},termsSharedCol:{flex:1},termsSectionBlock:{borderWidth:1,borderStyle:"solid",borderColor:"#e5e7eb",borderRadius:12,padding:14,marginBottom:10},termsSectionTitle:{fontSize:12,fontWeight:700,color:"#0f172a",marginBottom:6},termsParagraph:{fontSize:10,lineHeight:1.5,color:"#6b7280",marginBottom:6},termsPrivacyCard:{backgroundColor:"#f5f6f8",borderRadius:14,padding:16,marginTop:8,borderWidth:1,borderStyle:"solid",borderColor:"#e5e7eb"},termsPrivacyTitle:{color:"#111827",fontSize:12,fontWeight:700,marginBottom:6},termsPrivacyParagraph:{color:"#374151",fontSize:10,lineHeight:1.5,marginBottom:4},termsSupplyCard:{borderRadius:16,padding:18,backgroundColor:"#fff",borderWidth:1,borderStyle:"solid",borderColor:"#e8ecf2",marginBottom:12},termsSupplyEyebrow:{fontSize:8.5,color:"#9aa4b2",letterSpacing:1.6,textTransform:"uppercase"},termsSupplyTitle:{fontSize:16,fontWeight:700,color:"#111827",marginTop:4},termsSupplySummary:{fontSize:10,color:"#6b7280",marginTop:4,marginBottom:10,lineHeight:1.45},termsSupplySteps:{flexDirection:"row",gap:10},termsSupplyStepCol:{flex:1,borderRadius:12,padding:12,backgroundColor:"#f8fafc",borderWidth:1,borderStyle:"solid",borderColor:"#eef1f6"},termsIconWrap:{width:20,height:20,borderRadius:10,backgroundColor:"#e5e7eb",alignItems:"center",justifyContent:"center",marginRight:6}});function B(r){const l=typeof r=="number"&&Number.isFinite(r)?r:0;return new Intl.NumberFormat("it-IT",{style:"currency",currency:"EUR"}).format(l)}function _(r,l="—"){return typeof r=="string"&&r.trim().length>0?r:l}function ae(r){if(!r)return"—";const l=String(r).match(/^(\d{4})-(\d{2})-(\d{2})/);if(l){const[,o,a,c]=l;return`${c}-${a}-${o}`}return String(r)}function de(r){return(Array.isArray(r)?r:[]).map(o=>({category:_(o?.label??o?.category??"","-"),amount:typeof o?.amount=="number"&&Number.isFinite(o.amount)?o.amount:0,pieces:typeof o?.pieces=="number"&&Number.isFinite(o.pieces)&&o.pieces>0?o.pieces:null,surfaces:J(o?.surfaces)}))}function ce(r){return Array.isArray(r)?r.filter(Boolean):r&&typeof r=="object"?Object.values(r).filter(Boolean):[]}function me(r){if(!r||typeof r!="object")return"";const l=r.width_mm||r.larghezza_mm||r.larghezza,o=r.height_mm||r.altezza_mm||r.altezza;return l&&o?`L ${l} × H ${o} mm`:l?`L ${l} mm`:o?`H ${o} mm`:""}function he(r,l){switch(r){case"finestra":return $;case"zanzariera":return re;case"cassonetto":return te;case"persiana":return ee;case"tapparella":return Z;case"porta_blindata":return $;case"porta_interna":{const o=a=>{const c=Number(a?.width_mm||800),g=Number(a?.height_mm||2100),f=a?.color||"#ffffff",s=(a?.handle_position||"left")!=="left"?c-Math.round(c*.1):Math.round(c*.1),d=`<?xml version="1.0" encoding="UTF-8"?>
<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 ${c} ${g}' width='${c}' height='${g}'>
  <rect x='0' y='0' width='${c}' height='${g}' fill='${f}' stroke='#222' stroke-width='2'/>
  <rect x='${Math.round(c*.05)}' y='${Math.round(g*.03)}' width='${Math.round(c*.9)}' height='${Math.round(g*.94)}' fill='${f}' stroke='#222' stroke-width='1'/>
  <circle cx='${s}' cy='${Math.round(g/2)}' r='${Math.round(Math.min(c,g)*.02)}' fill='#bbb' stroke='#444'/>
</svg>`;return`data:image/svg+xml;utf8,${encodeURIComponent(d)}`};if(typeof window>"u")try{const{renderToStaticMarkup:a}=require("react-dom/server"),c=require("react"),{PortaInternaSvg:g}=require("../features/quotes/porta-interna/PortaInternaSvg"),f=a(c.createElement(g,{item:l}));return`data:image/svg+xml;utf8,${encodeURIComponent(f)}`}catch{return o(l)}return o(l)}default:return $}}function x(r,l){for(const o of l)if(r[o]!==void 0&&r[o]!==null&&String(r[o]).toString().trim()!=="")return r[o]}function E(r,l="Sì",o="No"){if(typeof r=="boolean")return r?l:o;if(typeof r=="string"){const a=r.trim().toLowerCase();if(["si","sì","yes","true","1","on"].includes(a))return l;if(["no","false","0","off"].includes(a))return o}}function ge(r){if(!r||typeof r!="object")return[];const l=[];let o=Number(r.width_mm??r.larghezza_mm??r.larghezza),a=Number(r.height_mm??r.altezza_mm??r.altezza),c;String(r.kind).toLowerCase(),c=Number.isFinite(o)&&Number.isFinite(a)?o*a/1e6:void 0,c&&c>0&&l.push(["Superficie",`${c.toFixed(2)} m²`]);const g=x(r,["price_total","prezzo_totale","price","prezzo"]),f=String(r.kind).toLowerCase(),b=Number(g);g!==void 0&&f!=="tapparella"&&f!=="persiana"&&f!=="cassonetto"&&!Number.isNaN(b)&&b>0&&l.push(["Totale",String(g)]);const s=x(r,["color","colore","profile_color","profilo_colore"]);if(s&&l.push(["Colore",String(s)]),f==="porta_interna"){const h=x(r,["apertura"]);if(h){const v=h==="battente"?"Apertura a battente":"Apertura scorrevole";l.push(["Tipo apertura",v])}const u=x(r,["sliding_direction"]);if(u&&h==="scorrevole"){const v=u==="sx"?"Scorrimento a sinistra":"Scorrimento a destra";l.push(["Direzione scorrimento",v])}}const d=x(r,["wood","legno"]);d&&l.push(["Legno",String(d)]);const y=x(r,["glass","vetro"]);y&&l.push(["Vetro",String(y)]);const p=x(r,["handle","maniglia"]);p&&l.push(["Maniglia",String(p)]);const C=x(r,["foil","pellicola"]);C&&l.push(["Pellicola",String(C)]);const S=x(r,["uw"]),T=[["Trasmittanza",S!=null&&String(S).trim()!==""?`<= ${String(S)} W/m²K`:void 0],["Trasmittanza",x(r,["trasmittanza"])],["Telaio",E(x(r,["con_telaio"]))],["Deceleratore",E(x(r,["deceleratore","has_deceleratore","con_deceleratore"]))],["Serratura",x(r,["serratura"])?"Sì":void 0],["Spioncino",x(r,["spioncino"])?"Sì":void 0],["Posizione maniglia",(()=>{const h=x(r,["handle_position"]);return h==="left"?"Sinistra":h==="right"?"Destra":h})()]];for(const[h,u]of T)u&&l.push([h,String(u)]);const k=new Set(l.map(([h])=>h.toLowerCase())),P=new Set(["id","kind","qty","title","label","width_mm","height_mm","larghezza_mm","altezza_mm","larghezza","altezza","price_mode","price_total","price_per_mq","unit_price","unitPrice","price","prezzo","misura_tipo","accessori_colore","reference","riferimento","image_url","imageUrl","serratura","spioncino","handle_position"]),m=String(r.kind).toLowerCase();(m==="persiana"||m==="cassonetto")&&(P.add("ante"),P.add("ante_count")),m==="porta_interna"&&(P.add("apertura"),P.add("sliding_direction"));for(const[h,u]of Object.entries(r)){if(u==null||String(u).trim()===""||typeof u=="object"||typeof u=="function"||P.has(h)||h==="serratura"||h==="spioncino"||h==="handle_position")continue;const j={profile_system:"Sistema profilo",system_profile:"Sistema profilo",color:"Colore",colore:"Colore",profilo_colore:"Colore profilo",glass:"Vetro",vetro:"Vetro",glazing:"Vetro",uw:"Trasmittanza",modello:"Modello",tipologia:"Tipologia",rete_colore:"Colore rete",rete_tipo:"Colore rete",tipo_rete:"Colore rete",mesh:"Colore rete",deceleratore:"Deceleratore",has_deceleratore:"Deceleratore",con_deceleratore:"Deceleratore",material:"Materiale",materiale:"Materiale",depth_mm:"Profondità",profondita_mm:"Profondità",celino_mm:"Celino",spalletta_mm:"Celino",extension_mm:"Celino",lamelle_type:"Lamelle",lamelle:"Lamelle",con_telaio:"Telaio",ante:"Ante",ante_count:"Ante",hinge_color:"Colore cerniere",hinges_color:"Colore cerniere",glass_spec:"Vetrocamera",vetro_stratigrafia:"Vetrocamera",stratigrafia_vetro:"Vetrocamera",handle_position:"Posizione maniglia",panel_type:"Tipo pannello"}[h]||h;if(!k.has(j.toLowerCase())){let z=String(u);(j==="Profondità"||j==="Spalletta"||j==="Celino")&&(/mm\b/i.test(z)||(z=`${z} mm`)),j==="Colore rete"&&(z=z.replace(/^mesh\s*/i,"").trim()),j==="Posizione maniglia"&&(z==="left"&&(z="Sinistra"),z==="right"&&(z="Destra")),l.push([j,z]),k.add(j.toLowerCase())}}return l}function fe({companyLogoUrl:r,customer:l,quoteNumber:o,issueDate:a,validityLabel:c,installTime:g,shippingIncluded:f,hasWindows:b}){return e.jsxs(e.Fragment,{children:[e.jsxs(n,{style:[t.headerGrid],children:[e.jsx(n,{style:t.colThird,children:e.jsxs(n,{style:t.brandCard,children:[r&&r.trim()?e.jsx(R,{src:r,style:t.logo}):e.jsx(R,{src:W,style:t.logo}),e.jsxs(i,{style:t.companyDetails,children:["X S.R.L.",`
`,"P.IVA 04062850120",`
`,"sede legale - Saronno (VA) 21047",`
`,"Via San Giuseppe, 95",`
`,"info@xinfissi.it · www.xinfissi.it · +39 345 457 3328"]})]})}),e.jsx(n,{style:t.colThird,children:e.jsxs(n,{style:t.clientCard,children:[e.jsx(i,{style:t.h2Tight,children:"Spettabile"}),e.jsx(i,{children:_(l?.name)}),_(l?.address,"")!==""?e.jsx(i,{children:_(l?.address)}):null,(()=>{const s=[_(l?.email,""),_(l?.phone,""),l?.vat&&l.vat.trim()?`P.IVA ${l.vat.trim()}`:""].filter(d=>d&&d.trim()!=="");return s.length>0?e.jsx(i,{style:t.small,children:s.join(" · ")}):null})()]})}),e.jsx(n,{style:t.colThird,children:e.jsxs(n,{style:t.stampCard,children:[e.jsxs(i,{style:t.stampTitle,children:["Offerta n° ",_(o,"-")]}),e.jsxs(i,{style:t.metaRow,children:[e.jsx(i,{style:t.metaLabel,children:"Emesso:"})," ",ae(a)]}),e.jsxs(i,{style:t.metaRow,children:[e.jsx(i,{style:t.metaLabel,children:"Validità:"})," ",_(c)]}),e.jsxs(i,{style:t.metaRow,children:[e.jsx(i,{style:t.metaLabel,children:"Termini completamento:"})," ",_(g)]})]})})]}),e.jsx(n,{style:t.block,children:e.jsx(n,{style:[t.box],children:b&&e.jsxs(n,{style:[t.row,{marginTop:0}],children:[e.jsxs(n,{style:{flex:1,paddingRight:8},children:[e.jsx(i,{style:t.label,children:"Ferramenta"}),e.jsx(i,{wrap:!1,children:"WINKHAUS + HOPPE"})]}),f&&e.jsxs(n,{style:{flex:1,paddingLeft:8},children:[e.jsx(i,{style:t.label,children:"Servizi"}),e.jsx(i,{wrap:!1,children:"Trasporto incluso"})]})]})})})]})}function pe({profileOverview:r}){const l=r&&r||null,o=Array.isArray(l?.features)?l.features.filter(Boolean):[];return!l?.imageUrl&&o.length===0?null:e.jsx(n,{style:[t.block,t.poBlock,{paddingTop:2,paddingBottom:2}],children:e.jsx(n,{style:t.poGrid,children:o.map((a,c)=>{const g=c===0;return e.jsxs(n,{style:g?[t.poCol,t.poFirstCol]:[t.poCol],wrap:!1,children:[a.eyebrow?e.jsx(i,{style:t.poEyebrow,children:String(a.eyebrow)}):null,a.title?e.jsx(i,{style:[t.poTitle,t.poTitleText],children:String(a.title)}):null,g&&l?.imageUrl?e.jsx(n,{style:t.poHeroAbsWrap,children:e.jsx(R,{src:l.imageUrl,style:t.poHeroAbs})}):null,a.description?e.jsx(i,{style:t.poDesc,children:String(a.description)}):null,e.jsx(n,{style:t.poDivider})]},`pof-${c}`)})})})}function ue({totals:r,items:l,mountingCost:o,hasDiscount:a,originalTotal:c,discountedTotal:g,discount:f,showTotalIncl:b,vatPercent:s}){return e.jsxs(n,{style:t.block,children:[e.jsx(i,{style:t.h2,children:"Riepilogo preventivo"}),e.jsxs(n,{style:t.table,children:[e.jsxs(n,{style:t.tr,children:[e.jsx(i,{style:[t.th,{flex:2}],children:"Categoria"}),e.jsx(i,{style:[t.th,t.right],children:"Importo"})]}),r.length>0?r.map((d,y)=>{const p=_(d.category,"-"),C=`row-${p}-${Number.isFinite(d.amount)?d.amount:0}-${y}`,S=d.pieces,L=oe(d.surfaces,l);return e.jsxs(n,{style:t.tr,children:[e.jsxs(i,{style:[t.td,{flex:2}],children:[e.jsx(i,{children:p}),typeof S=="number"&&S>0?e.jsxs(i,{style:t.piecesNote,children:[" · ",S," pezzi "]}):null,L.map(T=>e.jsxs(i,{style:t.piecesNote,children:[" ","· ",ie(T.mq),T.missingDimensions>0?` (${T.missingDimensions} senza dimensioni)`:""]},`${C}-${T.id}`))]}),e.jsx(i,{style:[t.td,t.right],children:B(d.amount)})]},C)}):e.jsxs(n,{style:t.tr,children:[e.jsx(i,{style:[t.td,{flex:2,color:"#777"}],children:"—"}),e.jsx(i,{style:[t.td,t.right,{color:"#777"}],children:"—"})]}),typeof o=="number"&&Number.isFinite(o)&&e.jsxs(n,{style:t.tr,children:[e.jsx(i,{style:[t.td,{flex:2}],children:"Montaggio"}),e.jsx(i,{style:[t.td,t.right],children:B(o)})]}),a?e.jsxs(e.Fragment,{children:[e.jsxs(n,{style:[t.tr],children:[e.jsx(i,{style:[t.td,{flex:2,fontWeight:700,backgroundColor:"#f7f7f7"}],children:"TOTALE (IVA ESCLUSA)"}),e.jsx(i,{style:[t.td,t.right,{fontWeight:700,backgroundColor:"#f7f7f7"}],children:B(c)})]}),e.jsxs(n,{style:[t.tr,t.pastelGreen,{borderBottomWidth:0}],children:[e.jsx(i,{style:[t.td,{flex:2,fontWeight:700}],children:f?.mode==="pct"&&typeof f?.pct=="number"&&f.pct>0?`TOTALE SCONTATO DEL ${f.pct}% (IVA ESCLUSA)`:"TOTALE SCONTATO (IVA ESCLUSA)"}),e.jsx(i,{style:[t.td,t.right,{fontWeight:700}],children:B(g)})]})]}):e.jsxs(n,{style:[t.tr,{borderBottomWidth:0}],children:[e.jsx(i,{style:[t.td,{flex:2,fontWeight:700,backgroundColor:"#f7f7f7"}],children:"TOTALE (IVA ESCLUSA)"}),e.jsx(i,{style:[t.td,t.right,{fontWeight:700,backgroundColor:"#f7f7f7"}],children:B(c)})]}),(()=>{const d=!!b,y=typeof s=="number"&&Number.isFinite(s)?s:22,p=a?g:c;if(!d)return null;const C=p*(1+y/100);return e.jsxs(n,{style:[t.tr,{borderTopWidth:0}],children:[e.jsx(i,{style:[t.td,{flex:2,fontWeight:700}],children:"TOTALE (IVA INCLUSA)"}),e.jsx(i,{style:[t.td,t.right,{fontWeight:700}],children:B(C)})]})})()]})]})}function ye({companyLogoUrl:r,items:l}){return e.jsxs(e.Fragment,{children:[r&&r.trim()?e.jsx(R,{src:r,style:t.logo}):e.jsx(R,{src:W,style:t.logo}),e.jsxs(n,{style:t.block,children:[e.jsx(i,{style:t.h2,children:"Dettaglio voci"}),l.length>0?l.map((o,a)=>{const c=o?.kind==="custom",g=a>0&&a%2===0,f=c?[]:ge(o),b=Array.isArray(o?.custom_fields)?o.custom_fields.filter(m=>{const h=m?.name??m?.label??m?.key,u=m?.value;return h&&String(h).trim()&&u!=null&&String(u).trim()}).map(m=>[String(m?.name??m?.label??m?.key).trim(),String(m?.value).trim()]):[],s=c?b:[...f,...b],d=(()=>{if(o?.title&&o.title.trim())return o.title.trim();let m=String(o?.kind||"Voce").trim();return m==="porta_blindata"&&(m="Porta blindata"),m.charAt(0).toUpperCase()+m.slice(1)})(),y=`Q.tà ${Number.isFinite(Number(o?.qty))?String(o.qty):"1"}`,p=String(o?.kind||"").toLowerCase(),C=me(o),S=s.length,T=Math.max(260,80+Math.min(40,S*7)),k=t.itemPhotoWrap,P=typeof o?.reference=="string"&&o.reference.trim()?o.reference.trim():typeof o?.riferimento=="string"&&o.riferimento.trim()?o.riferimento.trim():"";return e.jsxs(n,{wrap:!1,break:g,style:[t.itemCard,{minHeight:T}],children:[e.jsxs(n,{style:{width:20,alignItems:"center",marginRight:6,paddingTop:2},children:[e.jsx(i,{style:{fontSize:5,color:"#bbb",letterSpacing:.3},children:"POS"}),e.jsx(i,{style:{fontSize:10,color:"#999",marginTop:1},children:a+1})]}),e.jsxs(n,{style:k,children:[(()=>{try{const m=typeof o?.image_url=="string"?o.image_url:"",h=m&&!m.startsWith("blob:")?m:he(o?.kind,o),u=typeof h=="string"?h:W;return e.jsx(R,{src:u,style:t.photo})}catch(m){return console.warn("Errore nel calcolo immagine voce PDF",m),e.jsx(R,{src:W,style:t.photo})}})(),(()=>{const m=o?.width_mm??o?.larghezza_mm??o?.larghezza?String(o?.width_mm??o?.larghezza_mm??o?.larghezza):"—",h=o?.height_mm??o?.altezza_mm??o?.altezza?String(o?.height_mm??o?.altezza_mm??o?.altezza):"—";if(!(p==="finestra"||p==="cassonetto"||p==="tapparella"||p==="persiana"||p==="porta_blindata"||p==="porta_interna")){const v=(()=>{switch(p){case"zanzariera":case"custom":return-6;default:return-18}})(),j=(()=>{switch(p){case"zanzariera":case"custom":return 6;default:return 6}})();return e.jsxs(e.Fragment,{children:[e.jsx(i,{style:[t.dimW,{bottom:v}],children:m}),e.jsx(n,{style:[t.dimHWrap,{left:j}],children:e.jsx(i,{style:t.dimH,children:h})})]})}return null})()]}),e.jsxs(n,{style:t.itemContent,children:[e.jsxs(n,{style:t.itemHeader,children:[e.jsxs(n,{style:{flexDirection:"row",alignItems:"center",flexShrink:1},children:[e.jsx(i,{style:t.itemKind,children:d}),(()=>{const m=C;return m?e.jsxs(i,{style:t.itemDims,children:["· ",m]}):null})()]}),e.jsx(i,{style:t.itemQty,children:y})]}),P?e.jsx(i,{style:t.itemRef,children:P}):null,s.length>0&&e.jsx(n,{style:t.hr}),e.jsx(n,{style:t.detailGrid,children:s.map(([m,h],u)=>e.jsxs(n,{style:t.detailRow,children:[e.jsx(i,{style:t.detailLabel,children:m}),e.jsx(i,{style:t.detailValue,children:h})]},`kv-${u}`))})]})]},`card-${o?.id||o?.kind||"k"}-${a}`)}):e.jsx(n,{style:[t.itemCard,{justifyContent:"center"}],children:e.jsx(i,{style:{color:"#666"},children:"— Nessuna voce inserita —"})})]})]})}const xe=()=>e.jsx(M,{width:14,height:14,viewBox:"0 0 24 24",children:e.jsx(O,{d:"M12 12a4 4 0 1 0-4-4 4 4 0 0 0 4 4zm0 2c-4.42 0-8 2.24-8 5v1h16v-1c0-2.76-3.58-5-8-5z",fill:"#475467"})}),be=()=>e.jsx(M,{width:14,height:14,viewBox:"0 0 24 24",children:e.jsx(O,{d:"M4 20V4a2 2 0 0 1 2-2h8a2 2 0 0 1 2 2v6h4v10h-6v-3h-4v3H4zm4-12h2v2H8V8zm0 4h2v2H8v-2zm4-4h2v2h-2V8zm0 4h2v2h-2v-2z",fill:"#475467"})});function Se({companyLogoUrl:r,structuredTerms:l,terms:o,supplyOnlyPlan:a,paymentPlanColumns:c,sharedPaymentNotes:g,sharedNotesLeft:f,sharedNotesRight:b}){return e.jsxs(e.Fragment,{children:[r&&r.trim()?e.jsx(R,{src:r,style:t.logo}):e.jsx(R,{src:W,style:t.logo}),e.jsx(i,{style:[t.h2,{marginTop:6}],children:"Condizioni di Fornitura"}),e.jsx(n,{style:{height:1,backgroundColor:"#eee",marginVertical:10}}),l?e.jsxs(e.Fragment,{children:[e.jsxs(n,{style:t.termsPaymentSection,children:[e.jsx(i,{style:t.termsPaymentHeader,children:"Metodi di pagamento"}),e.jsxs(n,{style:t.termsSupplyCard,wrap:!1,children:[e.jsx(i,{style:t.termsSupplyTitle,children:"Solo fornitura (senza posa)"}),e.jsx(i,{style:t.termsSupplySummary,children:a.summary}),e.jsx(n,{style:t.termsSupplySteps,children:(a.steps||[]).map((s,d)=>e.jsx(n,{style:t.termsSupplyStepCol,children:e.jsxs(n,{style:t.termsPlanStepRow,children:[e.jsx(n,{style:t.termsPlanStepCircle,children:e.jsx(i,{style:t.termsPlanStepCircleText,children:String(d+1)})}),e.jsxs(n,{style:{flex:1},children:[e.jsx(i,{style:t.termsPlanStepLabel,children:s.label}),e.jsx(i,{style:t.termsPlanStepDesc,children:s.description})]})]})},`supply-step-${d}`))})]}),e.jsx(i,{style:t.termsPaymentGroupLabel,children:"Fornitura e posa"}),e.jsx(n,{style:t.termsPaymentRow,children:c.map(s=>e.jsxs(n,{style:t.termsPlanCard,wrap:!1,children:[e.jsxs(n,{style:t.termsPlanHeaderRow,children:[e.jsx(n,{style:t.termsIconWrap,children:s.id==="azienda"?e.jsx(be,{}):e.jsx(xe,{})}),e.jsx(i,{style:t.termsPlanTitleInline,children:s.id==="azienda"?"Aziende":"Privati"})]}),s.summary?e.jsx(i,{style:t.termsParagraph,children:s.summary}):null,(s.steps||[]).map((d,y)=>e.jsx(n,{style:t.termsPlanStep,children:e.jsxs(n,{style:t.termsPlanStepRow,children:[e.jsx(n,{style:t.termsPlanStepCircle,children:e.jsx(i,{style:t.termsPlanStepCircleText,children:String(y+1)})}),e.jsxs(n,{style:{flex:1},children:[e.jsx(i,{style:t.termsPlanStepLabel,children:d.label}),e.jsx(i,{style:t.termsPlanStepDesc,children:d.description})]})]})},`terms-plan-${s.id}-${y}`))]},`terms-plan-${s.id}`))})]}),g.length>0&&e.jsxs(n,{style:t.termsSharedCard,wrap:!1,children:[e.jsx(i,{style:t.termsSharedTitle,children:"Regole generali sui pagamenti"}),e.jsxs(n,{style:t.termsSharedGrid,children:[e.jsx(n,{style:t.termsSharedCol,children:f.map((s,d)=>e.jsxs(n,{style:t.termsNoteRow,children:[e.jsx(n,{style:t.termsNoteBullet}),e.jsx(i,{style:t.termsNoteText,children:s})]},`shared-note-left-${d}`))}),e.jsx(n,{style:t.termsSharedCol,children:b.map((s,d)=>e.jsxs(n,{style:t.termsNoteRow,children:[e.jsx(n,{style:t.termsNoteBullet}),e.jsx(i,{style:t.termsNoteText,children:s})]},`shared-note-right-${d}`))})]})]}),(l.sections||[]).map((s,d)=>e.jsxs(n,{style:t.termsSectionBlock,wrap:!1,children:[e.jsx(i,{style:t.termsSectionTitle,children:s.title}),(s.body||[]).map((y,p)=>e.jsx(i,{style:t.termsParagraph,children:y},`section-${d}-p-${p}`))]},`section-${d}`)),e.jsxs(n,{style:t.termsPrivacyCard,wrap:!1,children:[e.jsx(i,{style:t.termsPrivacyTitle,children:l.privacy.title}),(l.privacy.body||[]).map((s,d)=>e.jsx(i,{style:t.termsPrivacyParagraph,children:s},`privacy-${d}`))]})]}):e.jsx(i,{children:_(o)}),e.jsxs(n,{style:{marginTop:22},children:[e.jsx(i,{children:"Letto e confermato in ______________________ in data _____________________"}),e.jsx(n,{style:{height:28}}),e.jsxs(n,{style:t.row,children:[e.jsxs(n,{style:[t.col],children:[e.jsx(i,{children:"Cliente"}),e.jsx(n,{style:{height:40,borderBottomWidth:1,borderStyle:"solid",borderColor:"#e6e6e6",marginRight:18}})]}),e.jsxs(n,{style:[t.col],children:[e.jsx(i,{children:"Fornitore"}),e.jsx(n,{style:{height:40,borderBottomWidth:1,borderStyle:"solid",borderColor:"#e6e6e6",marginRight:18}})]})]})]})]})}function _e(r){const{companyLogoUrl:l,quoteNumber:o,issueDate:a,installTime:c,showShippingIncluded:g,customer:f,catTotals:b,mountingCost:s,totalExcluded:d,validityLabel:y,validityDays:p,terms:C,termsStructured:S,items:L,profileOverview:T}=r||{},k=ce(L),P=g!==!1,m=k.some(w=>{const I=String(w?.kind||"").toLowerCase();return I==="finestra"||I==="portafinestra"||I==="scorrevole"||/serrament/i.test(I)}),h=de(b),u=typeof s=="number"&&Number.isFinite(s)?s:0,v=h.reduce((w,I)=>w+I.amount,0)+u,j=!!(r?.discount&&typeof r.discount.discountedTotal=="number"&&r.discount.discountedTotal>=0&&r.discount.discountedTotal<(r.discount.originalTotal??1/0)),z=j?r.discount?.originalTotal??v:typeof d=="number"&&Number.isFinite(d)?d:v,G=j?r.discount.discountedTotal:z,D=typeof p=="number"&&isFinite(p)?`VALIDITÀ OFFERTA: ${p} giorni`:_(y),U=D&&D!=="—"?D.replace(/VALIDIT[ÀA][’']?\s*OFFERTA\s*:\s*/i,"").trim():"—",q=S&&typeof S=="object"?S:null,K=["privato","azienda"].map(w=>ne.find(I=>I.id===w)).filter(w=>!!w).map(w=>({id:w.id,label:w.label,tagline:w.tagline,summary:w.summary,steps:w.paymentPlan})),Q={label:A.label,tagline:A.tagline,summary:A.summary,steps:A.steps},N=F&&F.length>0?F:[],V=Math.ceil(N.length/2),Y=N.slice(0,V),X=N.slice(V);return e.jsxs(se,{children:[e.jsxs(H,{size:"A4",style:t.page,children:[e.jsx(fe,{companyLogoUrl:l,customer:f,quoteNumber:o,issueDate:a,validityLabel:U,installTime:c,shippingIncluded:P,hasWindows:m}),e.jsx(pe,{profileOverview:T}),e.jsx(ue,{totals:h,items:k,mountingCost:s,hasDiscount:j,originalTotal:z,discountedTotal:G,discount:r.discount??null,showTotalIncl:r.showTotalIncl,vatPercent:r.vatPercent})]}),e.jsx(H,{size:"A4",style:t.page,children:e.jsx(ye,{companyLogoUrl:l,items:k})}),e.jsx(H,{size:"A4",style:t.page,children:e.jsx(Se,{companyLogoUrl:l,structuredTerms:q,terms:C,supplyOnlyPlan:Q,paymentPlanColumns:K,sharedPaymentNotes:N,sharedNotesLeft:Y,sharedNotesRight:X})})]})}export{_e as QuotePDF,_e as default};
